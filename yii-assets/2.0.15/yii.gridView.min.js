!function(e){e.fn.yiiGridView=function(i){return l[i]?l[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(e.error("Method "+i+" does not exist in jQuery.yiiGridView"),!1):l.init.apply(this,arguments)};var i={filterUrl:void 0,filterSelector:void 0},t={},r={beforeFilter:"beforeFilter",afterFilter:"afterFilter"},n={},l={init:function(r){return this.each(function(){var n=e(this),a=e.extend({},i,r||{}),c=n.attr("id");void 0===t[c]&&(t[c]={}),t[c]=e.extend(t[c],{settings:a});var f=!1;o(n,"filter","change.yiiGridView keydown.yiiGridView",a.filterSelector,function(e){if("keydown"===e.type){if(13!==e.keyCode)return;f=!0}else if(f)return void(f=!1);return l.applyFilter.apply(n),!1})})},applyFilter:function(){var i=e(this),n=t[i.attr("id")].settings,l={};e.each(e(n.filterSelector).serializeArray(),function(){this.name in l||(l[this.name]=[]),l[this.name].push(this.value)});var o=Object.keys(l);e.each(yii.getQueryParams(n.filterUrl),function(i,t){-1===o.indexOf(i)&&-1===o.indexOf(i.replace(/\[\d*\]$/,""))&&(e.isArray(t)||(t=[t]),i in l?e.each(t,function(t,r){e.inArray(r,l[i])&&l[i].push(r)}):l[i]=t)});var a=n.filterUrl.indexOf("?"),c=a<0?n.filterUrl:n.filterUrl.substring(0,a),f=n.filterUrl.indexOf("#");a>=0&&f>=0&&(c+=n.filterUrl.substring(f)),i.find("form.gridview-filter-form").remove();var d=e("<form/>",{action:c,method:"get",class:"gridview-filter-form",style:"display:none","data-pjax":""}).appendTo(i);e.each(l,function(i,t){e.each(t,function(t,r){d.append(e("<input/>").attr({type:"hidden",name:i,value:r}))})});var s=e.Event(r.beforeFilter);i.trigger(s),!1!==s.result&&(d.submit(),i.trigger(r.afterFilter))},setSelectionColumn:function(i){var r=e(this),n=e(this).attr("id");if(void 0===t[n]&&(t[n]={}),t[n].selectionColumn=i.name,i.multiple&&i.checkAll){var l="#"+n+" input[name='"+i.checkAll+"']",a=i.class?"input."+i.class:"input[name='"+i.name+"']",c="#"+n+" "+a+":enabled";o(r,"checkAllRows","click.yiiGridView",l,function(){r.find(a+":enabled").prop("checked",this.checked)}),o(r,"checkRow","click.yiiGridView",c,function(){var e=r.find(a).length==r.find(a+":checked").length;r.find("input[name='"+i.checkAll+"']").prop("checked",e)})}},getSelectedRows:function(){var i=e(this),r=t[i.attr("id")],n=[];return r.selectionColumn&&i.find("input[name='"+r.selectionColumn+"']:checked").each(function(){n.push(e(this).parent().closest("tr").data("key"))}),n},destroy:function(){var i=[".yiiGridView",r.beforeFilter,r.afterFilter].join(" ");this.off(i);var l=e(this).attr("id");return e.each(n[l],function(i,t){e(document).off(t.event,t.selector)}),delete t[l],this},data:function(){var i=e(this).attr("id");return t[i]}};function o(i,t,r,l,o){var a=i.attr("id"),c=n[a];if(void 0!==c&&void 0!==c[t]){var f=c[t];e(document).off(f.event,f.selector)}void 0===c&&(n[a]={}),e(document).on(r,l,o),n[a][t]={event:r,selector:l}}}(window.jQuery);